<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>맞춤형 보험설계사 컨설팅</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 구글 폰트 추가 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* 기본 스타일 */
        :root {
            --primary-color: #2563EB;  /* 진한 파란색으로 변경 */
            --primary-light: #EFF6FF;  /* 연한 파란색 배경으로 변경 */
            --text-color: #1F2937;  
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        body {
            font-family: 'Pretendard', sans-serif;
            color: var(--text-color);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-y: auto; /* auto로 변경 */
            background: linear-gradient(135deg, #1E40AF, #3B82F6);  /* 파란색 그라데이션 배경 */
        }

        #app {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            min-height: 100vh;
            position: relative;
            overflow-y: auto; /* auto로 변경 */
            max-height: 100vh;
            overflow: hidden;
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
        }

        .setup-container {
            max-width: 500px;
            margin: 20px auto;
            padding: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: var(--shadow);
        }

        select, button {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 2px solid var(--primary-light);
            border-radius: 12px;
            font-size: 1rem;
        }

        button {
            background: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
        }

        button:hover {
            background: #1D4ED8;  /* 더 진한 파란색으로 변경 */
            transform: translateY(-2px);
        }

        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: white;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            min-height: 0;
        }

        .message {
            margin-bottom: 1rem;
            padding: 1rem;
            border-radius: 1rem;
            width: 100%;  /* 기본 너비 설정 */
            max-width: 80%;  /* 최대 너비 제한 */
            line-height: 1.5;
        }

        .assistant-message {
            background: linear-gradient(135deg, #F3F4F6, #EFF6FF);  /* 연한 파란색 그라데이션 */
            margin-left: 0;
            border: 1px solid rgba(37, 99, 235, 0.1);  /* 파란색 테두리 */
            box-shadow: 
                0 2px 4px rgba(0, 0, 0, 0.05),
                inset 0 1px 1px rgba(255, 255, 255, 0.7);
            color: #4B5563;
        }

        .user-message {
            background-color: #2563EB;  /* 진한 파란색으로 변경 */
            color: white;
            margin-left: auto;
            margin-right: 0;
            box-shadow: 0 2px 4px rgba(124, 58, 237, 0.2);
        }

        .input-area {
            position: relative;
            z-index: 20;
            background: white;
            padding: 12px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            margin-top: auto;
        }

        #userInput {
            flex: 1;
            padding: 12px;
            border: 2px solid var(--primary-light);
            border-radius: 12px;
            font-size: 1rem;
            outline: none;
            font-family: 'Pretendard', sans-serif;
            font-weight: 500;
            color: var(--text-color);
            background: white;
        }

        #userInput::placeholder {
            color: #9CA3AF;
        }

        #userInput:focus {
            border-color: #2563EB;
        }

        #sendBtn {
            width: auto;
            margin: 0;
            background: #2563EB;
            font-weight: 600;
            letter-spacing: -0.01em;
        }

        #sendBtn:hover {
            background: #1D4ED8;
        }

        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate-fade-in {
            animation: fade-in 0.5s ease-out forwards;
        }

        .page-title {
            background: linear-gradient(135deg, #2563EB, #1E40AF);  /* 파란색 그라데이션 */
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        .back-button {
            background: linear-gradient(to right, #2563EB, #1E40AF);
            color: white;
            font-weight: 600;
            padding: 0.75rem 1.25rem;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(124, 58, 237, 0.2);
            width: fit-content;
            margin-bottom: 1rem;
        }

        .back-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(124, 58, 237, 0.3);
        }

        /* concern 버튼 스타일 수정 */
        .concern-btn {
            background: white;
            border: 1px solid #E5E7EB;
            padding: 0.75rem 1rem;
            border-radius: 12px;
            font-weight: 500;
            text-align: left;
            transition: all 0.2s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #1F2937;  /* 기본 텍스트 색상 지정 */
        }

        .concern-btn:hover {
            background: linear-gradient(to right, #EFF6FF, #DBEAFE);  /* 파란색 계열 hover 효과 */
            border-color: #2563EB;
            transform: translateX(4px);
            color: #1F2937;  /* hover 시에도 같은 텍스트 색상 유지 */
        }

        .concern-btn:active {
            background: white;
            transform: translateX(0);
            border-color: #E5E7EB;
            color: #1F2937;  /* active 상태에서도 같은 텍스트 색상 유지 */
        }

        .concern-btn:focus {
            outline: none;
            background: white;
            border-color: #E5E7EB;
            transform: translateX(0);
            color: #1F2937;  /* focus 상태에서도 같은 텍스트 색상 유지 */
        }

        .concern-btn:focus:not(:focus-visible) {
            outline: none;
            background: white;
            border-color: #E5E7EB;
            transform: translateX(0);
            color: var(--text-color);
        }

        .concern-btn span {
            color: #2563EB;  /* 번호 색상 파란색으로 변경 */
            font-weight: 600;
            min-width: 24px;
        }

        /* 버튼 클릭 후 상태 초기화 */
        .concern-btn:not(:hover):not(:active):not(:focus) {
            background: white;
            border-color: #E5E7EB;
            transform: translateX(0);
            color: var(--text-color);
        }

        /* 크리에이터 사인 스타일 */
        .creator-signature {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.7);
            text-align: center;
            font-weight: 500;
            letter-spacing: -0.01em;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(37, 99, 235, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            transition: all 0.2s ease;
            white-space: nowrap;
            z-index: 10;
            opacity: 0;  /* 기본적으로 숨김 */
            visibility: hidden;  /* 기본적으로 숨김 */
        }

        /* 인트로 화면이 활성화될 때만 크리에이터 사인 표시 */
        #app > #introScreen.active ~ .creator-signature {
            opacity: 1;
            visibility: visible;
        }

        /* 다른 화면이 활성화될 때는 크리에이터 사인 숨김 */
        #app > #concernScreen.active ~ .creator-signature,
        #app > #chatArea.active ~ .creator-signature {
            opacity: 0;
            visibility: hidden;
        }

        .creator-signature:hover {
            color: white;
            background: rgba(37, 99, 235, 0.3);
        }

        .creator-signature svg {
            width: 16px;
            height: 16px;
            fill: currentColor;
        }

        /* 채팅 영역 반응형 스타일 */
        #chatArea {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            height: calc(100vh - 2rem);
            display: flex;
            flex-direction: column;
            height: calc(100vh - 80px);
            max-height: calc(100vh - 80px);
        }

        /* 디바이스별 반응형 스타일 */
        /* 모바일 */
        @media (max-width: 640px) {
            #app {
                padding: 0.5rem;
            }

            #chatArea {
                height: calc(100vh - 70px);
                max-height: calc(100vh - 70px);
            }

            .chat-container {
                padding: 1rem;
            }

            .message, .waiting-message {
                max-width: 85%;
                padding: 0.875rem;
            }

            .input-area {
                padding: 8px;
            }

            .creator-signature {
                bottom: 15px;
                font-size: 0.7rem;
                padding: 0.4rem 0.8rem;
            }
            
            #introScreen,
            #concernScreen {
                max-height: calc(100vh - 100px);
                padding: 1rem;
            }
        }

        /* 태블릿 & 아이패드 */
        @media (min-width: 641px) and (max-width: 1024px) {
            #app {
                padding-bottom: 140px;
            }

            #chatArea {
                height: calc(100vh - 75px);
                max-height: calc(100vh - 75px);
            }

            /* 아이패드 프로 최적화 */
            @media (min-width: 834px) {
                #chatArea {
                    max-width: 800px;
                }

                .setup-container {
                    max-width: 700px;
                }
            }

            @media (min-width: 1024px) {
                #chatArea {
                    max-width: 900px;
                }
            }

            #introScreen,
            #concernScreen {
                max-height: calc(100vh - 110px);
                padding: 1.5rem;
            }

            .message, .waiting-message {
                max-width: 80%;
                padding: 1rem;
            }
        }

        /* 데스크톱 */
        @media (min-width: 1025px) {
            #chatArea {
                max-width: 800px;
                height: calc(100vh - 3rem);
            }

            .chat-container {
                max-height: calc(100vh - 250px);
            }

            #introScreen,
            #concernScreen {
                max-height: calc(100vh - 130px);
                padding: 2rem;
            }
        }

        /* 큰 화면 */
        @media (min-width: 1440px) {
            #chatArea {
                max-width: 1000px;
            }
        }

        /* 고해상도 디스플레이 */
        @media (min-width: 1920px) {
            #chatArea {
                max-width: 1200px;
            }
        }

        /* 아이패드 가로/세로 모드 대응 */
        @media only screen and (min-device-width: 768px) and (max-device-width: 1024px) {
            /* 세로 모드 */
            @media (orientation: portrait) {
                #chatArea {
                    max-width: 90%;
                    height: calc(100vh - 4rem);
                }
            }

            /* 가로 모드 */
            @media (orientation: landscape) {
                #chatArea {
                    max-width: 85%;
                    height: calc(100vh - 3rem);
                }
            }
        }

        /* 아이패드 프로 특화 스타일 */
        @media only screen and (min-device-width: 1024px) and (max-device-width: 1366px) {
            #app {
                padding-bottom: 160px;
            }

            #chatArea {
                height: calc(100vh - 180px);
            }

            .chat-container {
                max-height: calc(100vh - 220px);
            }

            .message {
                font-size: 1.1rem;
                padding: 14px 18px;
            }

            .input-area {
                padding: 16px;
            }

            #userInput {
                font-size: 1.1rem;
                padding: 14px;
            }
        }

        /* 세로 화면 최적화 */
        @media (max-height: 700px) {
            .chat-container {
                max-height: calc(100vh - 180px);
            }

            .message {
                margin-bottom: 8px;
                padding: 8px 12px;
            }

            .creator-signature {
                bottom: 15px;
                padding: 0.3rem 0.6rem;
                font-size: 0.65rem;
            }
        }

        /* 스크롤바 스타일링 */
        .chat-container::-webkit-scrollbar {
            width: 6px;
        }

        .chat-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .chat-container::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 3px;
        }

        .chat-container::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* 화면 표시 관련 스타일 추가 */
        #app > div {
            position: absolute;
            width: 100%;
            max-width: 800px;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        #app > div.active {
            opacity: 1;
            visibility: visible;
            position: relative;
        }

        .hidden {
            display: none !important;
        }

        /* 인트로 화면 컨테이너 수정 */
        #introScreen {
            position: relative;
            margin-bottom: 60px;  /* 크리에이터 사인을 위한 여백 */
            max-height: calc(100vh - 120px);
            overflow-y: auto;
            padding: 2rem;
            scrollbar-width: thin;
            -webkit-overflow-scrolling: touch;
        }

        /* 컨텐츠 간격 조정 */
        .space-y-6 > * {
            margin-top: 0.5rem !important;
            margin-bottom: 0.5rem !important;
        }

        /* 아이콘 크기 축소 */
        .w-24 {
            width: min(4rem, 8vh) !important;
            height: min(4rem, 8vh) !important;
        }

        /* 여백 최적화 */
        .mb-8 {
            margin-bottom: 1.5rem !important;
        }

        .my-6 {
            margin-top: 1rem !important;
            margin-bottom: 1rem !important;
        }

        /* 폰트 사이즈 최적화 */
        .text-4xl {
            font-size: min(1.875rem, 4vh) !important;
            line-height: min(2.25rem, 4.5vh) !important;
        }

        .text-xl {
            font-size: min(1.125rem, 2.5vh) !important;
            line-height: min(1.5rem, 3vh) !important;
        }

        /* 버튼 패딩 최적화 */
        #startButton {
            padding-top: 0.75rem !important;
            padding-bottom: 0.75rem !important;
        }

        /* 반응형 조정 */
        @media (min-height: 800px) {
            #introScreen {
                max-height: 80vh;
            }
        }

        @media (max-height: 700px) {
            #introScreen {
                max-height: 85vh;
                padding: 0.75rem;
                margin-bottom: 45px;
            }

            .space-y-6 > * {
                margin-top: calc(0.375rem + 0.5vh) !important;
                margin-bottom: calc(0.375rem + 0.5vh) !important;
            }

            .w-24 {
                width: min(3rem, 6vh) !important;
                height: min(3rem, 6vh) !important;
            }

            #startButton {
                padding: calc(0.5rem + 0.5vh) !important;
            }

            .creator-signature {
                bottom: 15px;
                padding: 0.3rem 0.6rem;
                font-size: 0.65rem;
            }
        }

        @media (max-height: 600px) {
            #introScreen {
                max-height: 90vh;
                padding: 0.5rem;
                margin-bottom: 35px;
            }

            .space-y-6 > * {
                margin-top: calc(0.25rem + 0.3vh) !important;
                margin-bottom: calc(0.25rem + 0.3vh) !important;
            }
        }

        /* 답변 대기 메시지 스타일 */
        .waiting-message {
            background: linear-gradient(135deg, #F3F4F6, #EDE9FE);
            border: 1px solid rgba(139, 92, 246, 0.1);
            width: 100%;
            max-width: 80%;
            margin-left: 0;
            animation: pulse 1.5s infinite;
        }

        /* 상단 '다른 고민 나누기' 텍스트 스타일 */
        #chatArea .p-4.bg-gradient-to-r span {
            font-weight: 700;  /* 글자 굵기 증가 */
            letter-spacing: -0.025em;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
            color: rgba(255, 255, 255, 0.95);  /* 텍스트 색상 더 선명하게 */
        }

        /* 모바일 최적화 */
        @media (max-width: 640px) {
            #introScreen,
            #concernScreen {
                max-height: calc(100vh - 100px);
                padding: 1rem;
            }

            #chatArea {
                height: calc(100vh - 70px);
                max-height: calc(100vh - 70px);
            }

            #chatContainer {
                padding: 1rem;
            }
        }

        /* 태블릿 최적화 */
        @media (min-width: 641px) and (max-width: 1024px) {
            #introScreen,
            #concernScreen {
                max-height: calc(100vh - 110px);
                padding: 1.5rem;
            }

            #chatArea {
                height: calc(100vh - 75px);
                max-height: calc(100vh - 75px);
            }
        }

        /* 큰 화면 최적화 */
        @media (min-width: 1025px) {
            #introScreen,
            #concernScreen {
                max-height: calc(100vh - 130px);
                padding: 2rem;
            }

            #chatArea {
                height: calc(100vh - 90px);
                max-height: calc(100vh - 90px);
            }
        }

        /* 고민 선택 화면 상단 문구 스타일 수정 */
        .concern-title {
            text-align: center;
            margin-bottom: 1.5rem;  /* 하단 여백 줄임 */
            padding: 1.2rem;  /* 내부 여백 줄임 */
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(239, 246, 255, 0.85));
            border-radius: 1.2rem;
            box-shadow: 
                0 4px 15px rgba(0, 0, 0, 0.05),
                0 8px 30px rgba(37, 99, 235, 0.08),
                inset 0 1px 2px rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.7);
        }

        .concern-title h2 {
            color: #374151;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            letter-spacing: -0.025em;
            background: linear-gradient(135deg, #2563EB, #1E40AF);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.5);
        }

        .concern-title p {
            color: #6B7280;
            font-size: 1rem;
            line-height: 1.4;  /* 줄 간격 살짝 줄임 */
            font-weight: 500;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.5);
        }

        /* 채팅방 상단 헤더 스타일 */
        #chatArea .p-4.bg-gradient-to-r {
            background: linear-gradient(135deg, #8B5CF6, #6366F1);
            padding: 1rem 1.2rem;
            box-shadow: 
                0 4px 12px rgba(139, 92, 246, 0.15),
                inset 0 1px 1px rgba(255, 255, 255, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(8px);
        }

        /* 뒤로가기 버튼 스타일 수정 */
        #backButton {
            padding: 0.6rem;
            border-radius: 0.8rem;
            transition: all 0.2s ease;
            background: rgba(255, 255, 255, 0.25);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 
                0 2px 4px rgba(0, 0, 0, 0.1),
                0 4px 8px rgba(0, 0, 0, 0.05),
                inset 0 1px 1px rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(4px);
        }

        #backButton:hover {
            background: rgba(255, 255, 255, 0.35);
            transform: translateX(-2px);
            box-shadow: 
                0 4px 8px rgba(0, 0, 0, 0.15),
                0 8px 16px rgba(0, 0, 0, 0.1),
                inset 0 1px 1px rgba(255, 255, 255, 0.3);
        }

        #backButton:active {
            transform: translateX(0);
            background: rgba(255, 255, 255, 0.2);
            box-shadow: 
                0 2px 4px rgba(0, 0, 0, 0.1),
                inset 0 1px 1px rgba(255, 255, 255, 0.1);
        }

        /* 아이콘 스타일 */
        #backButton svg {
            width: 1.25rem;
            height: 1.25rem;
            stroke-width: 2.5;
            transition: transform 0.2s ease;
            filter: drop-shadow(0 1px 1px rgba(0, 0, 0, 0.1));
        }

        #backButton:hover svg {
            transform: translateX(-2px);
        }

        /* 버튼과 텍스트 컨테이너 스타일 */
        #chatArea .p-4.bg-gradient-to-r {
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        /* 고민 선택 화면 스크롤 스타일 수정 */
        #concernScreen {
            height: 100vh;
            max-height: 100vh;
            overflow-y: auto;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            -webkit-overflow-scrolling: touch; /* iOS 스크롤 부드럽게 */
        }

        /* 고민 선택 버튼 컨테이너 */
        .concern-buttons-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            flex: 1;
            min-height: min-content; /* 내용이 적어도 최소 높이 보장 */
        }

        /* 스크롤바 스타일링 */
        #concernScreen::-webkit-scrollbar {
            width: 6px;
        }

        #concernScreen::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 3px;
        }

        #concernScreen::-webkit-scrollbar-thumb {
            background: rgba(124, 58, 237, 0.3);
            border-radius: 3px;
        }

        #concernScreen::-webkit-scrollbar-thumb:hover {
            background: rgba(124, 58, 237, 0.5);
        }

        /* 아이패드 및 태블릿 대응을 위한 스타일 수정 */
        @media screen and (min-width: 768px) and (max-width: 1024px) {
            #app {
                height: 100%;
                min-height: 100%;
                padding: 1rem;
                overflow: hidden;
            }

            #concernScreen {
                height: 100%;
                max-height: calc(100vh - 2rem);
                overflow-y: auto;
                padding: 1rem;
                margin-top: 1rem;
            }

            #chatArea {
                height: 100%;
                max-height: calc(100vh - 2rem);
                margin-top: 1rem;
            }

            .concern-title {
                margin-top: 1rem;
                margin-bottom: 1.5rem;
            }

            #chatContainer {
                max-height: calc(100vh - 180px);
                overflow-y: auto;
            }

            /* 안전 영역 고려 */
            @supports (-webkit-touch-callout: none) {
                #app {
                    padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
                }
                
                #concernScreen, #chatArea {
                    max-height: calc(100vh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 2rem);
                }
            }
        }

        /* 스크롤바 스타일 */
        #concernScreen::-webkit-scrollbar,
        #chatContainer::-webkit-scrollbar {
            width: 6px;
        }

        #concernScreen::-webkit-scrollbar-track,
        #chatContainer::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 3px;
        }

        #concernScreen::-webkit-scrollbar-thumb,
        #chatContainer::-webkit-scrollbar-thumb {
            background: rgba(124, 58, 237, 0.3);
            border-radius: 3px;
        }

        #concernScreen::-webkit-scrollbar-thumb:hover,
        #chatContainer::-webkit-scrollbar-thumb:hover {
            background: rgba(124, 58, 237, 0.5);
        }

        /* 아이패드 에어 특화 스타일 */
        @media only screen 
        and (min-device-width: 820px) 
        and (max-device-width: 1180px) 
        and (-webkit-min-device-pixel-ratio: 2) {
            #app {
                padding-top: 2rem;
                height: 100%;
                min-height: 100%;
            }

            #concernScreen {
                padding-top: 2rem;
                height: calc(100vh - 4rem);
                max-height: calc(100vh - 4rem);
                overflow-y: auto;
            }

            #chatArea {
                padding-top: 2rem;
                height: calc(100vh - 4rem);
                max-height: calc(100vh - 4rem);
            }

            .concern-title {
                margin-top: 0.5rem;
            }

            #chatContainer {
                max-height: calc(100vh - 200px);
            }

            /* iOS 안전 영역 추가 고려 */
            @supports (-webkit-touch-callout: none) {
                #app {
                    padding-top: max(2rem, env(safe-area-inset-top));
                }

                #concernScreen, 
                #chatArea {
                    padding-top: max(2rem, env(safe-area-inset-top));
                    height: calc(100vh - max(4rem, env(safe-area-inset-top)) - env(safe-area-inset-bottom));
                    max-height: calc(100vh - max(4rem, env(safe-area-inset-top)) - env(safe-area-inset-bottom));
                }

                #chatContainer {
                    max-height: calc(100vh - 200px - env(safe-area-inset-top));
                }
            }
        }

        /* 로딩 애니메이션 */
        @keyframes pulse {
            0% {
                opacity: 1;
            }
            50% {
                opacity: 0.7;
            }
            100% {
                opacity: 1;
            }
        }

        /* 채팅 컨테이너 스타일 */
        #chatContainer {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            padding: 1rem;
            width: 100%;
        }

        /* 인트로 화면 특징 설명 박스 스타일 수정 */
        .grid-cols-2 > div:first-child {
            background: #EFF6FF;
        }
        
        .grid-cols-2 > div:first-child p:first-child {
            color: #2563EB;
        }

        .grid-cols-2 > div:last-child {
            background: #F1F5F9;
        }

        .grid-cols-2 > div:last-child p:first-child {
            color: #1E40AF;
        }

        /* 전문분야 태그 스타일 수정 */
        .flex-wrap span:nth-child(1) {
            background: #EFF6FF;
            color: #2563EB;
        }
        
        .flex-wrap span:nth-child(2) {
            background: #F0F9FF;
            color: #0369A1;
        }
        
        .flex-wrap span:nth-child(3) {
            background: #F0FDFF;
            color: #0E7490;
        }
        
        .flex-wrap span:nth-child(4) {
            background: #F0F9FF;
            color: #1E40AF;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen bg-gradient-to-r from-purple-600 to-blue-400 text-white font-sans">
    <div id="app" class="flex items-center justify-center min-h-screen bg-gradient-to-r from-purple-600 to-blue-400 text-white font-sans">
        <!-- 인트로 화면 -->
        <div id="introScreen" class="active w-full max-w-md p-6 bg-white rounded-2xl shadow-lg text-gray-800">
            <div class="text-center space-y-6">
                <!-- 아이콘 변경 -->
                <div class="flex justify-center mb-8">
                    <div class="w-24 h-24 relative animate-pulse">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="text-blue-600">
                            <path d="M11.584 2.376a.75.75 0 01.832 0l9 6a.75.75 0 11-.832 1.248L12 3.901 3.416 9.624a.75.75 0 01-.832-1.248l9-6z" />
                            <path fill-rule="evenodd" d="M20.25 10.332v9.918H21a.75.75 0 010 1.5H3a.75.75 0 010-1.5h.75v-9.918a.75.75 0 01.634-.74A49.109 49.109 0 0112 9c2.59 0 5.134.202 7.616.592a.75.75 0 01.634.74zm-7.5 2.418a.75.75 0 00-1.5 0v6.75a.75.75 0 001.5 0v-6.75zm3-.75a.75.75 0 01.75.75v6.75a.75.75 0 01-1.5 0v-6.75a.75.75 0 01.75-.75zM9 12.75a.75.75 0 00-1.5 0v6.75a.75.75 0 001.5 0v-6.75z" clip-rule="evenodd" />
                            <path d="M12 7.875a1.125 1.125 0 100-2.25 1.125 1.125 0 000 2.25z" />
                        </svg>
                    </div>
                </div>

                <!-- 메인 타이틀 변경 -->
                <h1 class="text-4xl font-bold bg-gradient-to-r from-purple-600 to-pink-500 bg-clip-text text-transparent">
                    보험설계사의 길잡이
                </h1>
                <p class="text-xl text-gray-600 italic">당신의 성공을 함께 만들어갑니다</p>

                <!-- 서브 타이틀 변경 -->
                <div class="text-sm text-gray-500 space-y-1">
                    <p>전문 상담가와 함께하는</p>
                    <p>맞춤형 보험설계사 컨설팅</p>
                </div>

                <!-- 전문분야 리스트 변경 -->
                <div class="flex flex-wrap justify-center gap-2 my-6">
                    <span class="px-3 py-1 bg-purple-100 text-purple-600 rounded-full text-sm">영업기법</span>
                    <span class="px-3 py-1 bg-pink-100 text-pink-600 rounded-full text-sm">고객관리</span>
                    <span class="px-3 py-1 bg-blue-100 text-blue-600 rounded-full text-sm">상품지식</span>
                    <span class="px-3 py-1 bg-indigo-100 text-indigo-600 rounded-full text-sm">리스크관리</span>
                </div>

                <!-- 특징 설명 변경 -->
                <div class="grid grid-cols-2 gap-3 text-sm text-gray-600">
                    <div class="p-3 bg-purple-50 rounded-lg">
                        <p class="font-semibold text-purple-600">맞춤 상담</p>
                        <p>당신의 상황에 맞는 최적의 조언</p>
                    </div>
                    <div class="p-3 bg-pink-50 rounded-lg">
                        <p class="font-semibold text-pink-600">전문 컨설팅</p>
                        <p>경험많은 전문가의 맞춤 케어</p>
                    </div>
                </div>

                <!-- 시작하기 버튼 변경 -->
                <button id="startButton" class="w-full py-4 px-6 bg-gradient-to-r from-purple-600 to-pink-500 text-white rounded-xl font-semibold transform transition-all hover:scale-105 hover:shadow-lg">
                    나만의 성공 스토리 시작하기
                </button>

                <!-- 하단 텍스트 변경 -->
                <p class="text-sm text-gray-500 mt-4">
                    성공적인 보험설계사의 길, 함께 만들어가겠습니다
                </p>
            </div>
        </div>

        <!-- 고민 선택 화면 -->
        <div id="concernScreen" class="hidden w-full max-w-md p-6">
            <div class="concern-title">
                <h2>어떤 고민이 있으신가요?</h2>
                <p>전문가와 함께 이야기를 나누어보세요</p>
            </div>
            <div id="concernSelection" class="space-y-1">
                <button class="concern-btn w-full py-2 px-3 bg-gray-50 hover:bg-purple-50 rounded-xl text-left text-gray-700 transition-all text-sm">
                    <span>1</span>
                    신규 고객 발굴이 어려워요
                </button>
                <button class="concern-btn w-full py-2 px-3 bg-gray-50 hover:bg-purple-50 rounded-xl text-left text-gray-700 transition-all text-sm">
                    <span>2</span>
                    기존 고객 관리는 어떻게 하는 것이 좋을까요?
                </button>
                <button class="concern-btn w-full py-2 px-3 bg-gray-50 hover:bg-purple-50 rounded-xl text-left text-gray-700 transition-all text-sm">
                    <span>3</span>
                    계약 성사율을 높이고 싶어요
                </button>
                <button class="concern-btn w-full py-2 px-3 bg-gray-50 hover:bg-purple-50 rounded-xl text-left text-gray-700 transition-all text-sm">
                    <span>4</span>
                    고객과의 신뢰 관계 형성이 어려워요
                </button>
                <button class="concern-btn w-full py-2 px-3 bg-gray-50 hover:bg-purple-50 rounded-xl text-left text-gray-700 transition-all text-sm">
                    <span>5</span>
                    상품 설명이 어렵게 느껴져요
                </button>
                <button class="concern-btn w-full py-2 px-3 bg-gray-50 hover:bg-purple-50 rounded-xl text-left text-gray-700 transition-all text-sm">
                    <span>6</span>
                    거절 처리가 힘들어요
                </button>
                <button class="concern-btn w-full py-2 px-3 bg-gray-50 hover:bg-purple-50 rounded-xl text-left text-gray-700 transition-all text-sm">
                    <span>7</span>
                    업계 경쟁이 심해서 불안해요
                </button>
                <button class="concern-btn w-full py-2 px-3 bg-gray-50 hover:bg-purple-50 rounded-xl text-left text-gray-700 transition-all text-sm">
                    <span>8</span>
                    시간 관리가 잘 안돼요
                </button>
                <button class="concern-btn w-full py-2 px-3 bg-gray-50 hover:bg-purple-50 rounded-xl text-left text-gray-700 transition-all text-sm">
                    <span>9</span>
                    스트레스 관리가 힘들어요
                </button>
                <button class="concern-btn w-full py-2 px-3 bg-gray-50 hover:bg-purple-50 rounded-xl text-left text-gray-700 transition-all text-sm">
                    <span>10</span>
                    실적 압박감이 심해요
                </button>
                <button class="concern-btn w-full py-2 px-3 bg-gray-50 hover:bg-purple-50 rounded-xl text-left text-gray-700 transition-all text-sm">
                    <span>11</span>
                    소득이 불안정해서 걱정이에요
                </button>
                <button class="concern-btn w-full py-2 px-3 bg-gray-50 hover:bg-purple-50 rounded-xl text-left text-gray-700 transition-all text-sm">
                    <span>12</span>
                    디지털 전환에 적응하기 어려워요
                </button>
                <button class="concern-btn w-full py-2 px-3 bg-gray-50 hover:bg-purple-50 rounded-xl text-left text-gray-700 transition-all text-sm">
                    <span>13</span>
                    법규와 컴플라이언스가 어려워요
                </button>
                <button class="concern-btn w-full py-2 px-3 bg-gray-50 hover:bg-purple-50 rounded-xl text-left text-gray-700 transition-all text-sm">
                    <span>14</span>
                    경력 개발은 어떻게 해야 할까요?
                </button>
                <button class="concern-btn w-full py-2 px-3 bg-gray-50 hover:bg-purple-50 rounded-xl text-left text-gray-700 transition-all text-sm">
                    <span>15</span>
                    그 외 보험설계사 활동에 대해 궁금한 점이 있어요
                </button>
            </div>
        </div>

        <!-- 채팅 영역 -->
        <div id="chatArea" class="hidden">
            <div class="flex flex-col h-full">
                <button id="backButton" class="mb-4 px-4 py-2 bg-gray-50 hover:bg-purple-50 text-gray-700 rounded-xl text-sm flex items-center transition-all font-medium">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                    </svg>
                    다른 고민 나누기
                </button>

                <div id="chatContainer" class="chat-container bg-gray-50 rounded-2xl p-4">
                    <!-- 메시지들이 여기에 추가됨 -->
                </div>

                <div class="input-area mt-4 bg-gray-50 rounded-xl p-2 flex gap-2">
                    <input type="text" 
                           id="userInput" 
                           class="flex-1 px-4 py-2 rounded-xl border-0 bg-white focus:ring-2 focus:ring-purple-500 outline-none text-sm text-gray-800" 
                           placeholder="메시지를 입력하세요...">
                    <button id="sendBtn" 
                            class="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-xl text-sm transition-all">
                        전송
                    </button>
                </div>
            </div>
        </div>

        <!-- 크리에이터 사인 -->
        <div class="creator-signature">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2Z"/>
            </svg>
            Created by Sagittarius
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const screens = {
                intro: document.querySelector('#introScreen'),
                concern: document.querySelector('#concernScreen'),
                chat: document.querySelector('#chatArea')
            };
            
            const startButton = document.querySelector('#startButton');
            const chatContainer = document.querySelector('#chatContainer');
            const userInput = document.querySelector('#userInput');
            const sendBtn = document.querySelector('#sendBtn');

            // 초기 상태 설정
            screens.intro.classList.add('active');
            screens.concern.classList.add('hidden');
            screens.chat.classList.add('hidden');

            // 대화 기록을 저장할 배열 추가
            let conversationHistory = [];

            // 화면 전환 함수
            function showScreen(screenElement) {
                // 모든 화면 숨기기
                Object.values(screens).forEach(screen => {
                    screen.classList.remove('active');
                    screen.classList.add('hidden');
                });
                
                // 선택된 화면만 보이기
                screenElement.classList.remove('hidden');
                screenElement.classList.add('active');

                // concern 화면으로 전환될 때 모든 버튼 상태 초기화
                if (screenElement === screens.concern) {
                    document.querySelectorAll('.concern-btn').forEach(btn => {
                        btn.blur();
                        btn.style.background = 'white';
                        btn.style.transform = 'none';
                        btn.style.borderColor = '#E5E7EB';
                    });
                }
            }

            // 사용자 메시지 추가 함수
            function addUserMessage(message) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message user-message ml-auto';
                messageDiv.textContent = message;
                chatContainer.appendChild(messageDiv);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }

            // 어시스턴트 메시지 추가 함수
            function addAssistantMessage(message) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message assistant-message';
                messageDiv.textContent = message;
                chatContainer.appendChild(messageDiv);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }

            // 답변 대기 메시지 추가 함수
            function addWaitingMessage() {
                const waitingMessage = document.createElement('div');
                waitingMessage.className = 'message assistant-message waiting-message';
                waitingMessage.innerHTML = `
                    <div class="flex items-center gap-2">
                        <div class="animate-pulse">
                            <div class="h-2 w-2 bg-purple-500 rounded-full"></div>
                        </div>
                        <div class="animate-pulse">
                            <div class="h-2 w-2 bg-purple-500 rounded-full"></div>
                        </div>
                        <div class="animate-pulse">
                            <div class="h-2 w-2 bg-purple-500 rounded-full"></div>
                        </div>
                        <span class="text-sm text-gray-500">답변을 작성중입니다...</span>
                    </div>
                `;
                chatContainer.appendChild(waitingMessage);
                chatContainer.scrollTop = chatContainer.scrollHeight;
                return waitingMessage;
            }

            // OpenAI API 호출 함수 수정
            async function callOpenAI(message) {
                try {
                    conversationHistory.push({
                        role: "user",
                        content: message
                    });

                    const response = await fetch('https://api.openai.com/v1/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': 'Bearer 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'
                        },
                        body: JSON.stringify({
                            model: "gpt-4",
                            messages: [
                                {
                                    role: "system",
                                    content: `당신은 한국에서 20년 이상의 현장 경험을 가진 최고의 보험설계사 전문 멘토입니다.
                                            각 답변은 다음과 같은 3단계 구조로 진행해 주세요:

                                            1. 공감 단계 (1문장)
                                               - "저도 GA/본사 설계사 시절에 그런 어려움을 겪었습니다"
                                               - 한국 보험설계사의 현실적 고민에 공감하는 표현

                                            2. 해결책 제시 (2문장)
                                               - 한국 시장에 맞는 구체적인 실행방안 한 가지 제시
                                               - 예시:
                                                 * "네이버 카페에서 매일 오전 30분 상담하기"
                                                 * "카카오톡 채널로 기존 고객 관리하기"
                                                 * "아파트 맘카페 육아보험 상담"
                                                 * "퇴근시간 직장인 밀집지역 보장분석 서비스"

                                            3. 후속 질문 (1문장)
                                               - 제시한 해결책과 관련된 질문 하나만 하기
                                               - 실천 가능한 범위의 구체적 질문

                                            핵심 원칙:
                                            - 한국 보험시장 현실에 맞는 조언하기
                                            - 한 번에 한 가지 주제만 다루기
                                            - 구체적인 시간과 방법 명시하기
                                            - 법규와 윤리 기준 준수하기
                                            - 불필요한 설명 피하기`
                                },
                                ...conversationHistory
                            ],
                            temperature: 0.7,
                            max_tokens: 1000
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const data = await response.json();
                    
                    if (data.error) {
                        throw new Error(data.error.message);
                    }

                    const assistantResponse = data.choices[0].message.content;
                    conversationHistory.push({
                        role: "assistant",
                        content: assistantResponse
                    });

                    return assistantResponse;
                } catch (error) {
                    console.error('API Error:', error);
                    return "현재 서비스 연결에 문제가 있습니다. 잠시 후 다시 시도해주세요. 불편을 드려 죄송합니다.";
                }
            }

            // 메시지 전송 처리 함수 수정
            async function handleSendMessage() {
                const message = userInput.value.trim();
                if (message) {
                    addUserMessage(message);
                    userInput.value = '';
                    
                    const waitingMessage = addWaitingMessage();
                    try {
                        const response = await callOpenAI(message);
                        waitingMessage.remove();
                        addAssistantMessage(response);
                    } catch (error) {
                        waitingMessage.remove();
                        addAssistantMessage("죄송합니다. 일시적인 오류가 발생했습니다. 잠시 후 다시 시도해주세요.");
                    }
                }
            }

            // 메시지 전송 이벤트
            sendBtn.addEventListener('click', handleSendMessage);
            userInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handleSendMessage();
                }
            });

            // 시작 버튼 클릭 이벤트
            startButton.addEventListener('click', () => {
                showScreen(screens.concern);
            });

            // 고민 선택 버튼들 이벤트 수정
            const concernButtons = document.querySelectorAll('.concern-btn');
            concernButtons.forEach((button, index) => {
                button.addEventListener('click', async () => {
                    const concernText = button.textContent.trim();
                    showScreen(screens.chat);
                    const waitingMessage = addWaitingMessage();
                    
                    // 대화 기록 초기화
                    conversationHistory = [];
                    
                    try {
                        const response = await callOpenAI(concernText);
                        waitingMessage.remove();
                        addAssistantMessage(response);
                    } catch (error) {
                        waitingMessage.remove();
                        addAssistantMessage("죄송합니다. 일시적인 오류가 발생했습니다. 잠시 후 다시 시도해주세요.");
                    }
                });
            });

            // 뒤로가기 버튼 이벤트
            const backButton = document.querySelector('#backButton');
            if (backButton) {
                backButton.addEventListener('click', () => {
                    showScreen(screens.concern);
                    chatContainer.innerHTML = '';
                    conversationHistory = []; // 대화 기록 초기화
                });
            }
        });
    </script>
</body>
</html>
